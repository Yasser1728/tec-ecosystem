name: "ÙØ­Øµ Ø§Ù„Ø£Ù…Ø§Ù† Ø¹Ø¨Ø± ÙƒÙˆØ¯Ø§Ø³ÙŠ - Codacy Security Scan"

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: read

jobs:
  codacy-security-scan:
    permissions:
      contents: read 
      security-events: write 
      actions: read 
    
    name: "Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© ÙØ­Øµ Ø§Ù„Ø­ÙˆÙƒÙ…Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†"
    runs-on: ubuntu-latest
    
    steps:
      - name: "ğŸ“¥ Ø¬Ù„Ø¨ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ØµØ¯Ø±ÙŠ"
        uses: actions/checkout@v4

      - name: "ğŸ›¡ï¸ ØªØ´ØºÙŠÙ„ Ù…Ø­Ø±Ùƒ ÙØ­Øµ ÙƒÙˆØ¯Ø§Ø³ÙŠ"
        uses: codacy/codacy-analysis-cli-action@v4
        with:
          project-token: ${{ secrets.CODACY_PROJECT_TOKEN }}
          verbose: true
          output: results.sarif
          format: sarif
          # ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ù‡Ù†Ø§ Ù„ØªÙƒÙˆÙ† Ù…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ù…Ø­Ø±Ùƒ Docker
          directory: "."

      - name: "ğŸ“Š Ø±ÙØ¹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ù…Ø§Ù† Ø¥Ù„Ù‰ Ø¬ÙŠØª Ù‡Ø§Ø¨"
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: results.sarif
