ØªÙ…Ø§Ù…ØŒ Ø³Ø£Ø¹Ø·ÙŠÙƒ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù„Ù…Ù„Ù index.js / Orchestrator Ø¨Ø­ÙŠØ« ØªÙƒÙˆÙ† Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¥Ù†ØªØ§Ø¬ ÙˆÙ„Ù€ SandboxØŒ Ù…Ø¹ Ø¯Ø¹Ù… Ø§Ù„Ù€ 24 Ø¯ÙˆÙ…ÙŠÙ†ØŒ Retry MechanismØŒ ÙˆØªØµÙ†ÙŠÙ Ø§Ù„Ø®Ø¯Ù…Ø§Øª (Groups).

// ============================================
// TEC Sovereign OS - Secure Environment Loader
// ============================================
import 'dotenv/config'; // Ù„ØªØ­Ù…ÙŠÙ„ .env ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Local
import fs from 'fs';
import path from 'path';

// Helper: read env safely
function getEnv(key, fallback = '') {
    if (process.env[key]) return process.env[key];
    return fallback;
}

// ============================================
// Configuration
// ============================================
const CONFIG = {
    runMode: getEnv('NODE_ENV', 'production'), // production | sandbox | development
    models: {
        gpt: getEnv('GPT_MODEL', 'openai/gpt-5.2-pro'),
        claude: getEnv('CLAUDE_MODEL', 'anthropic/claude-4.5-sonnet'),
        gemini: getEnv('GEMINI_MODEL', 'google/gemini-3-pro'),
        codex: getEnv('CODEX_MODEL', 'openai/gpt-5.1-codex-max'),
        deepseek: getEnv('DEEPSEEK_MODEL', 'deepseek/deepseek-r1:free'),
        llama: getEnv('LLAMA_MODEL', 'meta-llama/llama-3.1-405b-instruct:free'),
        qwen: getEnv('QWEN_MODEL', 'qwen/qwen3-coder-480b-a35b:free'),
        hermes: getEnv('HERMES_MODEL', 'nousresearch/hermes-3-llama-3.1-405b:free'),
        gpt_oss: getEnv('GPT_OSS_FREE', 'openai/gpt-oss-120b:free'),
        gemini_flash: getEnv('GEMINI_FLASH_FREE', 'google/gemini-2.0-flash:free'),
        o4: getEnv('O4_ENGINEER_MODEL', 'openai/o4-mini-high'),
        devstral: getEnv('DEVSTRAL_MODEL', 'mistralai/devstral-2-2512:free')
    },
    apiKey: getEnv('OPENROUTER_API_KEY', ''),
    servicesFolder: path.join(process.cwd(), 'ai-agent', 'services'),
    maxRetries: 2 // Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø¹Ù†Ø¯ ÙØ´Ù„ Ø£ÙŠ Ø®Ø¯Ù…Ø©
};

// Check critical keys
if (!CONFIG.apiKey) {
    console.error('âŒ OPENROUTER_API_KEY is missing! Set it in GitHub Secrets or .env');
    process.exit(1);
}

// ============================================
// Domain Groups
// ============================================
const DOMAIN_GROUPS = {
    core: ['tec', 'commerce', 'finance', 'wallet', 'market'],
    analytics: ['analytics', 'tokens', 'nft', 'exchange'],
    management: ['crm', 'payments', 'governance', 'legal', 'audit'],
    ops: ['devops', 'infra', 'support', 'hr'],
    elite: ['vip', 'titan', 'nexus', 'explorer', 'zone', 'elite']
};

function filterServicesByGroup(services, groupName) {
    if (!DOMAIN_GROUPS[groupName]) return services;
    return services.filter(svc => DOMAIN_GROUPS[groupName].includes(svc.name));
}

// ============================================
// Dynamic Service Loader
// ============================================
async function loadServices() {
    const services = [];
    try {
        const files = fs.readdirSync(CONFIG.servicesFolder);
        for (const file of files) {
            if (file.endsWith('.js')) {
                const servicePath = path.join(CONFIG.servicesFolder, file);
                try {
                    const module = await import(servicePath);
                    services.push({
                        name: path.basename(file, '.js'),
                        module
                    });
                    console.log(`âœ… Loaded service: ${file}`);
                } catch (err) {
                    console.warn(`âš ï¸ Failed to load ${file}: ${err.message}`);
                }
            }
        }
    } catch (err) {
        console.error(`âŒ Services folder not found: ${CONFIG.servicesFolder}`);
    }
    return services;
}

// ============================================
// Safe Run with Retry
// ============================================
async function safeRunService(svc, config) {
    for (let attempt = 1; attempt <= config.maxRetries + 1; attempt++) {
        try {
            await svc.module.run(config);
            console.log(`âœ… Service ${svc.name} succeeded`);
            return;
        } catch (err) {
            console.warn(`âš ï¸ Attempt ${attempt} failed for ${svc.name}: ${err.message}`);
            if (attempt === config.maxRetries + 1) {
                console.error(`âŒ Service ${svc.name} permanently failed`);
            } else {
                await new Promise(res => setTimeout(res, 1000 * attempt)); // ØªØ£Ø®ÙŠØ± Ù…ØªØ²Ø§ÙŠØ¯
            }
        }
    }
}

// ============================================
// Main Orchestrator
// ============================================
async function runSovereignServices(group = null) {
    console.log('ğŸš€ Sovereign OS Services Booting...');
    let services = await loadServices();

    if (group) {
        services = filterServicesByGroup(services, group);
        console.log(`ğŸ”¹ Running services in group: ${group}`);
    }

    console.log(`ğŸš€ Total services loaded: ${services.length}`);

    for (const svc of services) {
        if (svc.module && typeof svc.module.run === 'function') {
            await safeRunService(svc, CONFIG);
        }
    }

    console.log('ğŸ¯ Sovereign OS Services Finished!');
}

// ============================================
// Execute if called directly
// ============================================
if (import.meta.url === `file://${process.argv[1]}`) {
    const groupArg = process.argv[2]; // optional: node index.js analytics
    runSovereignServices(groupArg).catch(err => console.error('ğŸ’¥ Fatal:', err));
}

// ============================================
// Exports
// ============================================
export { CONFIG, loadServices, runSovereignServices, safeRunService };


---

âœ… Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©

1. ØªØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ ÙƒÙ„ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ù€ 24 Ø£Ùˆ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø­Ø¯Ø¯Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…:



node index.js analytics

2. Retry Mechanism: ÙƒÙ„ Ø®Ø¯Ù…Ø© ØªÙØ­Ø§ÙˆÙ„ Ù…Ø±ØªÙŠÙ† Ø¥Ø¶Ø§ÙÙŠØªÙŠÙ† Ø¥Ø°Ø§ ÙØ´Ù„Øª.


3. Group Filtering: ÙŠÙ…ÙƒÙ† ØªØ´ØºÙŠÙ„ Core Ø£Ùˆ Analytics Ø£Ùˆ Ops Ø¥Ù„Ø® Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯.


4. Production/Sandbox Ready: ØªØ³ØªØ®Ø¯Ù… .env Ù…Ø­Ù„ÙŠØ§Ù‹ Ø£Ùˆ GitHub Secrets Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ.


5. Ø³Ø¬Ù„ ÙƒÙ„ Ø®Ø¯Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ù„ØªÙ†ÙÙŠØ°ØŒ Ù…Ø¹ Ø­Ù…Ø§ÙŠØ© Ù…Ù† ÙØ´Ù„ Ø£ÙŠ ÙˆØ­Ø¯Ø© Ø¯ÙˆÙ† ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø¨Ù‚ÙŠØ©.




---

Ø¥Ø°Ø§ Ø£Ø­Ø¨Ø¨ØªØŒ Ø£Ù‚Ø¯Ø± Ø£Ø¬Ù‡Ø² Ù„Ùƒ Ù…Ù„Ù sovereign-factory.yml Ù…Ø­Ø¯Ø« Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø­ÙŠØ« ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ù‡Ø°Ø§ index.js Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ ÙˆÙŠØ´ØºÙ„ Ø§Ù„Ù€ 24 Ø¯ÙˆÙ…ÙŠÙ† Ø¨Ø´ÙƒÙ„ Ø¢Ù„ÙŠ Ø¹Ù„Ù‰ GitHub ActionsØŒ ÙˆÙŠØ­ØªÙØ¸ Ø¨Ø§Ù„Ù€ Artifacts ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ©.

Ù‡Ù„ ØªØ±ÙŠØ¯ Ø£Ù† Ø£ÙØ¹Ù„ Ø°Ù„ÙƒØŸ
